<!-- resource/static/admin/table-manager.html -->
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Quản lý bàn ăn</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/item-manager.css">
    <link rel="stylesheet" href="../css/modal.css">

</head>
<body>
    <!-- Tiêu đề -->
    <div class="header">
        <button class="menu-btn" onclick="toggleSidebar()">&#9776;</button>
        <h1>Quản lý bàn ăn</h1>

        <span id="headerClock" class="header-clock" aria-label="Giờ hiện tại"></span>

        <div class="user-info" id="userInfo"></div>
    </div>

    <!-- Thanh bên -->
    <div class="sidebar" id="sidebar">
        <button class="close-btn" onclick="toggleSidebar()">&#9776;</button>
        <a href="dashboard.html">Thống kê</a>
        <a href="categories.html">Quản lý danh mục</a>
        <a href="item-manager.html">Quản lý món ăn</a>
        <a href="table-manager.html">Quản lý bàn</a>
        <a href="staff-manager.html">Quản lý nhân viên</a>
    </div>

    <!-- Thêm bàn (dành cho admin) -->
    <div id="adminActions" class="admin-actions" style="text-align: end; margin-right: 20px; display: none;">
            <button class="btn" onclick="showAddTable()" style=" font-size: 20px;">➕ Thêm bàn</button>
    </div>

    <!-- Bộ lọc bàn -->
    <div style="text-align: center; margin: 15px;">
        <label for="tableFilter"><strong>Lọc bàn:</strong></label>
        <select id="tableFilter" onchange="loadTables()" style="padding: 6px; font-size: 16px;">
            <option value="ALL">Tất cả</option>
            <option value="Trống">Trống</option>
            <option value="Đang phục vụ">Đang phục vụ</option>
            <option value="Chờ thanh toán">Chờ thanh toán</option>
        </select>
    </div>

    <!-- Danh sách bàn -->
    <div class="table-grid" id="tableContainer"></div>

    <!-- Modal cho chi tiết đơn hàng -->
    <div id="modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <h3>Chi tiết đơn</h3>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Modal thêm bàn mới -->
<div id="addTableModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeAddTableModal()">&times;</span>
    <h2>Thêm bàn mới</h2>

    <div class="form-group">
      <label for="newTableNumber">Số bàn</label>
      <input type="number" id="newTableNumber" placeholder="Nhập số bàn" />
    </div>

    <div class="form-group">
      <label for="newTableCapacity">Sức chứa</label>
      <input type="number" id="newTableCapacity" placeholder="Nhập sức chứa" />
    </div>

    <div class="form-error" id="addTableError"></div>

    <div style="text-align:right; margin-top: 12px;">
      <button class="btn primary" onclick="submitNewTable()">Lưu</button>
    </div>
  </div>
</div>

<!-- Modal cập nhật bàn -->
<div id="editTableModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeEditTableModal()">&times;</span>
    <h2>Cập nhật bàn</h2>

    <div class="form-group">
      <label for="editTableNumber">Số bàn</label>
      <input type="text" id="editTableNumber" readonly style="background-color:#f3f4f6;" />
    </div>

    <div class="form-group">
      <label for="editQrCodeUrl">QR Code URL</label>
      <input type="text" id="editQrCodeUrl" readonly style="background-color:#f3f4f6;" />
    </div>

    <div class="form-group">
      <label for="editStatus">Trạng thái</label>
      <select id="editStatus">
        <option value="Trống">Trống</option>
        <option value="Đang phục vụ">Đang phục vụ</option>
        <option value="Chờ thanh toán">Chờ thanh toán</option>
      </select>
    </div>

    <div class="form-group">
      <label for="editCapacity">Sức chứa</label>
      <input type="number" id="editCapacity" />
    </div>

    <div class="form-error" id="editTableError"></div>

    <div style="text-align:right; margin-top: 12px;">
      <button class="btn primary" onclick="submitEditTable()">Lưu</button>
    </div>
  </div>
</div>

<!-- Modal sửa món trong đơn -->
<div id="editModal" class="modal hidden">
  <div class="modal-backdrop" onclick="closeEditModal()"></div>
  <div class="modal-body">
    <h3>Sửa món</h3>
    <label>Số lượng</label>
    <input type="number" id="editQuantity" min="1">

    <label>Ghi chú</label>
    <textarea id="editNotes"></textarea>

    <div class="modal-actions">
      <button onclick="closeEditModal()">Hủy</button>
      <button onclick="saveEdit()">Lưu</button>
    </div>
  </div>
</div>


<!-- Modal xác nhận thanh toán -->
<div id="payModal" class="modal" style="display:none;">
  <div class="modal-content" style="max-width:720px;">
    <span class="close" onclick="closePayModal()">&times;</span>
    <h2>Xác nhận thanh toán</h2>

    <div id="payInfo" style="margin:8px 0 12px;color:#374151;"></div>

    <div class="table-responsive" style="max-height:320px;overflow:auto;border:1px solid #eee;border-radius:8px;">
      <table style="width:100%;border-collapse:collapse;">
        <thead>
          <tr style="background:#f8fafc;">
            <th style="text-align:left;padding:10px;border-bottom:1px solid #eee;">Món</th>
            <th style="text-align:center;padding:10px;border-bottom:1px solid #eee;">SL</th>
            <th style="text-align:right;padding:10px;border-bottom:1px solid #eee;">Đơn giá</th>
            <th style="text-align:right;padding:10px;border-bottom:1px solid #eee;">Thành tiền</th>
          </tr>
        </thead>
        <tbody id="payItems"></tbody>
      </table>
    </div>

    <div id="paySummary" style="text-align:right;margin-top:12px;font-weight:600;"></div>

    <div id="payError" class="form-error" style="display:none;margin-top:8px;"></div>

    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px;">
      <button class="btn" onclick="closePayModal()">Hủy</button>
      <button class="btn primary" id="btnConfirmPay" onclick="confirmPay()">Xác nhận thanh toán</button>
      <button class="btn" id="btnViewInvoice" style="display:none;" onclick="viewInvoice()">Xem/In hóa đơn</button>
    </div>
  </div>
</div>



<script src="js/config.js"></script>
<script src="js/auth-fetch.js"></script>
<script src="js/common.js"></script>
<script src="js/table-manager.js"></script>


<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.6.1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</body>
</html>
